# 自訂區間功能測試指南

## 功能概述
報告頁面的自訂區間功能允許用戶選擇特定的日期範圍來查看薪資報告數據。

## 測試步驟

### 1. 基本功能測試
1. 進入報告頁面
2. 點擊「詳細設定」按鈕
3. 在「自訂日期範圍」區域輸入開始和結束日期
4. 驗證日期選擇是否正確更新報告數據

### 2. 日期驗證測試
- **測試案例 1**: 開始日期晚於結束日期
  - 預期結果: 顯示錯誤訊息「開始日期不能晚於結束日期」
  
- **測試案例 2**: 結束日期是未來日期
  - 預期結果: 顯示錯誤訊息「結束日期不能是未來日期」
  
- **測試案例 3**: 只選擇一個日期
  - 預期結果: 顯示錯誤訊息「請選擇開始和結束日期」

### 3. 快速選擇測試
1. 選擇年份和月份
2. 點擊「套用年月設定」按鈕
3. 驗證日期是否正確設置為該月的第一天和最後一天

### 4. API 測試
使用以下 API 端點測試自訂區間：
```
GET /api/reports/summary?startDate=2024-01-01&endDate=2024-12-31
```

## 修復的問題

### 1. API 端點缺失
- 在 `config/api.ts` 中添加了 `REPORTS` API 端點
- 包括 `SUMMARY`、`EXPORT_PDF`、`EXPORT_CSV` 和 `CUSTOM_RANGE` 端點

### 2. 數據獲取邏輯
- 修改了 `Reports.tsx` 中的數據獲取邏輯
- 添加了日期範圍計算函數
- 實現了自訂區間的 API 調用

### 3. 日期驗證
- 添加了完整的日期驗證邏輯
- 包括開始日期、結束日期和未來日期的驗證
- 添加了錯誤訊息顯示

### 4. 後端 API 修復
- 修復了 CSV 導出 API 中的參數獲取問題
- 確保 `startDate` 和 `endDate` 參數正確處理

## 預期行為

1. **正常情況**: 用戶選擇有效的日期範圍後，報告數據會根據選擇的時間區間更新
2. **錯誤處理**: 無效的日期選擇會顯示相應的錯誤訊息
3. **數據一致性**: 報告數據與選擇的時間區間保持一致
4. **用戶體驗**: 界面響應迅速，提供清晰的視覺反饋

## 注意事項

- 確保後端 API 正確處理日期參數
- 驗證數據庫查詢是否正確過濾日期範圍
- 測試不同時區的日期處理
- 確保錯誤訊息的多語言支持

